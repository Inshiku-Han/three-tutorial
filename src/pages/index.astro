---
import Layout from "../layouts/Layout.astro";
---

<Layout />

<script>
    import * as THREE from "three";
    import { OrbitControls } from "three-stdlib";

    const renderer = new THREE.WebGLRenderer();

    const scene = new THREE.Scene();

    // cemera에는 Perspective와 Orthographic 두가지가 있다.
    const camera = new THREE.PerspectiveCamera(
        45, // field of view(각도)
        window.innerWidth / window.innerHeight, // aspect ratio(비율)
        0.1, // near clipping plane(가까운 평면)
        1000 // far clipping plane(멀리 있는 평면)
        // near부터 far 까지를 렌더링
    );
    // camera의 위치 조정(x, y, z)
    camera.position.set(-10, 30, 30);

    // 궤도. 마우스로 드래그해서 카메라를 이동시킬 수 있다.
    const orbit = new OrbitControls(camera, renderer.domElement);
    orbit.update();

    // 박스생성
    const boxGemometry = new THREE.BoxGeometry();
    const boxMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    const box = new THREE.Mesh(boxGemometry, boxMaterial);
    scene.add(box);

    // 평먼 생성
    const planeGemoetry = new THREE.PlaneGeometry(30, 30);
    const planeMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
    const plane = new THREE.Mesh(planeGemoetry, planeMaterial);
    scene.add(plane);

    // gltf 로드
    // const loader = new GLTFLoader();
    // loader.load(
    //     "/gltf/out.glb",
    //     (gltf) => scene.add(gltf.scene),
    //     undefined,
    //     (error) => console.error(error)
    // );

    // 축을 시각화하여 보여준다.
    const axesHelper = new THREE.AxesHelper(30);
    scene.add(axesHelper);

    // 그리드를 시각화하여 보여준다.
    const gridHelper = new THREE.GridHelper(30);
    scene.add(gridHelper);

    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setAnimationLoop((time) => {
        box.rotation.x = time / 1000;
        box.rotation.y = time / 1000;
        renderer.render(scene, camera);
    });

    document.body.appendChild(renderer.domElement);
</script>
